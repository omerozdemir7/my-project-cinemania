import{j as s,r as i,f as M,L as H,H as T,M as _,s as $}from"./index-DDp8UiQY.js";function F({totalPages:o,currentPage:l,onPageChange:d}){if(o<=1)return null;const r=5;let h=Math.max(l-2,1),c=Math.min(h+r-1,o);c-h<r-1&&(h=Math.max(c-r+1,1));const t=[];t.push(s.jsx("button",{className:"pagination-arrow",disabled:l===1,onClick:()=>d(l-1),children:"«"},"prev")),h>1&&(t.push(s.jsx("button",{className:"pagination-btn",onClick:()=>d(1),children:"1"},1)),h>2&&t.push(s.jsx("span",{className:"pagination-dots",children:"..."},"dots1")));for(let a=h;a<=c;a++)t.push(s.jsx("button",{className:`pagination-btn ${a===l?"active":""}`,onClick:()=>d(a),children:a},a));return c<o&&(c<o-1&&t.push(s.jsx("span",{className:"pagination-dots",children:"..."},"dots2")),t.push(s.jsx("button",{className:"pagination-btn",onClick:()=>d(o),children:o},o))),t.push(s.jsx("button",{className:"pagination-arrow",disabled:l===o,onClick:()=>d(l+1),children:"»"},"next")),s.jsx("div",{className:"pagination",children:t})}function Q({onMovieClick:o,onWatchTrailer:l}){const[d,r]=i.useState(!0),[h,c]=i.useState(null),[t,a]=i.useState([]),[k,w]=i.useState(1),[C,p]=i.useState(1),[u,y]=i.useState(""),[f,g]=i.useState(""),[j,x]=i.useState(!1),v=i.useRef(null);i.useEffect(()=>{E()},[]),i.useEffect(()=>{const e=n=>{v.current&&!v.current.contains(n.target)&&x(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const E=async()=>{r(!0);const e=await M(1);r(!1),e?.results?.length&&(a(e.results),p(e.total_pages),c(e.results[0]))},Y=async e=>{e.preventDefault(),u.trim()&&(w(1),await b(u,f,1))},b=async(e,n,N)=>{r(!0);const m=await $(e,N,n);if(r(!1),!m?.results?.length){a([]),p(1);return}a(m.results),p(Math.min(m.total_pages,500)),m.results[0]&&c(m.results[0])},D=e=>{w(e),u?b(u,f,e):L(e),window.scrollTo({top:0,behavior:"smooth"})},L=async e=>{r(!0);const n=await M(e);r(!1),n?.results?.length&&(a(n.results),p(n.total_pages),c(n.results[0]))},O=e=>{const n=t.find(N=>N.id===e);n&&c(n),window.scrollTo({top:0,behavior:"smooth"})},R=new Date().getFullYear(),S=[];for(let e=R;e>=1950;e--)S.push(e);return s.jsxs(s.Fragment,{children:[d&&s.jsx(H,{}),s.jsx(T,{movie:h,onWatchTrailer:l,onMoreDetails:o}),s.jsx("section",{className:"search-section",children:s.jsx("div",{className:"container",children:s.jsxs("form",{className:"search-form",onSubmit:Y,children:[s.jsx("input",{type:"text",className:"search-bar",placeholder:"Search",value:u,onChange:e=>y(e.target.value)}),s.jsxs("div",{className:`custom-dropdown ${j?"active":""}`,ref:v,children:[s.jsxs("div",{className:"dropdown-header",onClick:e=>{e.stopPropagation(),x(!j)},children:[s.jsx("span",{style:{color:f?"var(--primary-orange)":""},children:f||"Year"}),s.jsx("i",{className:"fas fa-chevron-down"})]}),s.jsxs("ul",{className:`dropdown-list ${j?"":"is-hidden"}`,children:[s.jsx("li",{className:"dropdown-item",onClick:()=>{g(""),x(!1)},children:"Year"}),S.map(e=>s.jsx("li",{className:"dropdown-item",onClick:()=>{g(e.toString()),x(!1)},children:e},e))]})]}),s.jsx("button",{type:"submit",className:"search-btn",children:s.jsx("i",{className:"fas fa-search"})})]})})}),s.jsx("section",{className:"movie-grid-section",children:s.jsx("div",{className:"container",children:t.length===0&&!d?s.jsxs("div",{className:"no-results-container",children:[s.jsx("h2",{children:"OOPS!"}),s.jsx("h3",{children:"Search result not successful"}),s.jsx("p",{children:"Enter a different keyword or remove the search filter"})]}):s.jsx("div",{className:"movie-grid-container",children:t.map(e=>s.jsx(_,{movie:e,onClick:O},e.id))})})}),s.jsx("section",{className:"pagination-section",children:s.jsx("div",{className:"container",children:s.jsx(F,{totalPages:C,currentPage:k,onPageChange:D})})})]})}export{Q as CatalogPage};
