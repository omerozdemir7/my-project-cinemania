import{j as s,r as o,f as M,L as H,H as T,M as _,s as $}from"./index-izTSw8yN.js";function F({totalPages:r,currentPage:l,onPageChange:d}){if(r<=1)return null;const c=5;let u=Math.max(l-2,1),t=Math.min(u+c-1,r);t-u<c-1&&(u=Math.max(t-c+1,1));const n=[];n.push(s.jsx("button",{className:"pagination-arrow",disabled:l===1,onClick:()=>d(l-1),children:"«"},"prev")),u>1&&(n.push(s.jsx("button",{className:"pagination-btn",onClick:()=>d(1),children:"1"},1)),u>2&&n.push(s.jsx("span",{className:"pagination-dots",children:"..."},"dots1")));for(let a=u;a<=t;a++)n.push(s.jsx("button",{className:`pagination-btn ${a===l?"active":""}`,onClick:()=>d(a),children:a},a));return t<r&&(t<r-1&&n.push(s.jsx("span",{className:"pagination-dots",children:"..."},"dots2")),n.push(s.jsx("button",{className:"pagination-btn",onClick:()=>d(r),children:r},r))),n.push(s.jsx("button",{className:"pagination-arrow",disabled:l===r,onClick:()=>d(l+1),children:"»"},"next")),s.jsx("div",{className:"pagination",children:n})}function Q({onMovieClick:r,onWatchTrailer:l}){const[d,c]=o.useState(!0),[u,t]=o.useState(null),[n,a]=o.useState([]),[k,w]=o.useState(1),[C,p]=o.useState(1),[h,y]=o.useState(""),[f,g]=o.useState(""),[j,x]=o.useState(!1),v=o.useRef(null);o.useEffect(()=>{E()},[]),o.useEffect(()=>{const e=i=>{v.current&&!v.current.contains(i.target)&&x(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);const E=async()=>{c(!0);const e=await M(1);c(!1),e?.results?.length?(a(e.results),p(e.total_pages),t(e.results[0])):(a([]),t(null))},Y=async e=>{e.preventDefault(),h.trim()&&(w(1),await b(h,f,1))},b=async(e,i,N)=>{c(!0);const m=await $(e,N,i);if(c(!1),!m?.results?.length){a([]),p(1),t(null);return}a(m.results),p(Math.min(m.total_pages,500)),m.results[0]&&t(m.results[0])},D=e=>{w(e),h?b(h,f,e):L(e),window.scrollTo({top:0,behavior:"smooth"})},L=async e=>{c(!0);const i=await M(e);c(!1),i?.results?.length?(a(i.results),p(i.total_pages),t(i.results[0])):(a([]),t(null))},O=e=>{const i=n.find(N=>N.id===e);i&&t(i),window.scrollTo({top:0,behavior:"smooth"})},R=new Date().getFullYear(),S=[];for(let e=R;e>=1950;e--)S.push(e);return s.jsxs(s.Fragment,{children:[d&&s.jsx(H,{}),s.jsx(T,{movie:u,onWatchTrailer:l,onMoreDetails:r}),s.jsx("section",{className:"search-section",children:s.jsx("div",{className:"container",children:s.jsxs("form",{className:"search-form",onSubmit:Y,children:[s.jsx("input",{type:"text",className:"search-bar",placeholder:"Search",value:h,onChange:e=>y(e.target.value)}),s.jsxs("div",{className:`custom-dropdown ${j?"active":""}`,ref:v,children:[s.jsxs("div",{className:"dropdown-header",onClick:e=>{e.stopPropagation(),x(!j)},children:[s.jsx("span",{style:{color:f?"var(--primary-orange)":""},children:f||"Year"}),s.jsx("i",{className:"fas fa-chevron-down"})]}),s.jsxs("ul",{className:`dropdown-list ${j?"":"is-hidden"}`,children:[s.jsx("li",{className:"dropdown-item",onClick:()=>{g(""),x(!1)},children:"Year"}),S.map(e=>s.jsx("li",{className:"dropdown-item",onClick:()=>{g(e.toString()),x(!1)},children:e},e))]})]}),s.jsx("button",{type:"submit",className:"search-btn",children:s.jsx("i",{className:"fas fa-search"})})]})})}),s.jsx("section",{className:"movie-grid-section",children:s.jsx("div",{className:"container",children:n.length===0&&!d?s.jsxs("div",{className:"no-results-container",children:[s.jsx("h2",{children:"OOPS!"}),s.jsx("h3",{children:"Search result not successful"}),s.jsx("p",{children:"Enter a different keyword or remove the search filter"})]}):s.jsx("div",{className:"movie-grid-container",children:n.map(e=>s.jsx(_,{movie:e,onClick:O},e.id))})})}),s.jsx("section",{className:"pagination-section",children:s.jsx("div",{className:"container",children:s.jsx(F,{totalPages:C,currentPage:k,onPageChange:D})})})]})}export{Q as CatalogPage};
