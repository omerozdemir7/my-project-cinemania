{"version":3,"mappings":"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","names":["firebaseConfig","app","initializeApp","auth","getAuth","db","getFirestore","loginBtn","logoutBtn","modalBackdrop","closeBtn","authForm","emailInput","passInput","authTitle","submitBtn","switchBtn","accountContainer","dropdownEmailSpan","changePasswordBtn","isLoginMode","onAuthStateChanged","user","sendPasswordResetEmail","error","email","password","signInWithEmailAndPassword","createUserWithEmailAndPassword","signOut","getUserLibrary","userRef","doc","docSnap","getDoc","addToLibrary","movieId","id","setDoc","arrayUnion","list","removeFromLibrary","updateDoc","arrayRemove","item","API_KEY","BASE_URL","IMG_URL","IMG_ORIGINAL_URL","fetchFromAPI","endpoint","params","lang","url","key","res","err","fetchPopularMovies","page","fetchTrendingMovies","period","fetchUpcomingMovies","searchMovies","query","year","fetchMovieDetails","fetchMovieVideos","getImageUrl","path","getOriginalImageUrl","fetchMovieProviders","setupModal","backdrop","poster","title","voteAvg","voteCount","popularity","genre","description","addBtn","providersContainer","providersList","watchLink","googleBtn","openModal","movie","providersData","g","trData","provider","img","titleEncoded","pName","targetUrl","numericMovieId","library","closeModal","e","originalText","setupTeamModal","openBtn","onEscKeyPress","nav","logo","overlay","isMobile","openNav","closeNav","link","themeToggle","body","addGoogleScript","script","langs","el","changeLanguage","langCode","cookieValue","moduleName","__vitePreload","href","dropdown","langBtn","langList","langOpt","selectedLang","langBtnRef","icon","openTrailerModal","videoKey","iframe","closeTrailerModal","onEsc","openTrailerErrorModal","closeErrorModal","getGenresText","genreData","firstItem","genreMap","genres","renderStars","vote","stars","html","i","renderMovieCard","genreList","updateHeroWithMovie","heroSection","heroContent","bg","trailerBtn","trailer","v","detailBtn","renderUpcomingSection","container","releaseDate","imageUrl","btnText","btn","currentLib","index","showLoader","loader","hideLoader"],"ignoreList":[],"sources":["../../src/js/auth.js","../../src/js/movies-data.js","../../src/js/modal.js","../../src/js/team-modal.js","../../src/js/mobile-nav.js","../../src/js/theme-toggle.js","../../src/js/main.js","../../src/js/trailer-modal.js","../../src/js/ui-helpers.js","../../src/js/loader.js"],"sourcesContent":["// src/js/auth.js\r\n\r\n// Firebase kütüphanelerini import ediyoruz\r\nimport { initializeApp } from \"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js\";\r\nimport { \r\n  getAuth, \r\n  createUserWithEmailAndPassword, \r\n  signInWithEmailAndPassword, \r\n  signOut, \r\n  onAuthStateChanged,\r\n  sendPasswordResetEmail // <-- EKLENDI\r\n} from \"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js\";\r\n\r\nimport { \r\n  getFirestore, \r\n  doc, \r\n  setDoc, \r\n  getDoc, \r\n  updateDoc, \r\n  arrayUnion, \r\n  arrayRemove \r\n} from \"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js\";\r\n\r\n// --- SENİN FIREBASE AYARLARIN ---\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBmuibsjXBem9CN6pB-0nye7NryFJSya2g\",\r\n  authDomain: \"filmorex.firebaseapp.com\",\r\n  projectId: \"filmorex\",\r\n  storageBucket: \"filmorex.firebasestorage.app\",\r\n  messagingSenderId: \"962389606250\",\r\n  appId: \"1:962389606250:web:4ba4c4fd8d70b077e56f13\",\r\n  measurementId: \"G-XYT7Y5H7G9\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nexport const auth = getAuth(app);\r\nconst db = getFirestore(app);\r\n\r\n// --- DOM ELEMENTLERİ ---\r\nconst loginBtn = document.getElementById('btn-login');\r\n// logoutBtn artık sadece tıklama işlevi için var, görünürlüğü dropdown yönetiyor\r\nconst logoutBtn = document.getElementById('btn-logout'); \r\nconst modalBackdrop = document.getElementById('auth-modal-backdrop');\r\nconst closeBtn = document.getElementById('auth-close-btn');\r\nconst authForm = document.getElementById('auth-form');\r\nconst emailInput = document.getElementById('auth-email');\r\nconst passInput = document.getElementById('auth-password');\r\nconst authTitle = document.getElementById('auth-title');\r\nconst submitBtn = document.getElementById('auth-submit-btn');\r\nconst switchBtn = document.getElementById('auth-switch-btn');\r\nconst accountContainer = document.getElementById('user-account-container'); \r\nconst dropdownEmailSpan = document.getElementById('dropdown-email');\r\nconst changePasswordBtn = document.getElementById('btn-change-password');\r\n\r\nlet isLoginMode = true;\r\n\r\n// --- KULLANICI DURUMUNU TAKİP ET ---\r\nonAuthStateChanged(auth, (user) => {\r\n  if (user) {\r\n    // Giriş yapıldıysa: Login butonu GİZLE, Hesabım menüsü GÖSTER\r\n    if(loginBtn) loginBtn.classList.add('is-hidden');\r\n    if(accountContainer) accountContainer.classList.remove('is-hidden');\r\n    \r\n    if (dropdownEmailSpan) dropdownEmailSpan.textContent = user.email;\r\n  } else {\r\n    // Çıkış yapıldıysa: Login butonu GÖSTER, Hesabım menüsü GİZLE\r\n    if(loginBtn) loginBtn.classList.remove('is-hidden');\r\n    if(accountContainer) accountContainer.classList.add('is-hidden');\r\n    \r\n    if (dropdownEmailSpan) dropdownEmailSpan.textContent = '';\r\n  }\r\n});\r\n\r\n// --- ŞİFRE DEĞİŞTİRME ---\r\nif (changePasswordBtn) {\r\n  changePasswordBtn.onclick = async (e) => {\r\n    e.preventDefault();\r\n    const user = auth.currentUser;\r\n    if (user && user.email) {\r\n      const confirmReset = confirm(`${user.email} adresine şifre sıfırlama bağlantısı gönderilsin mi?`);\r\n      if (confirmReset) {\r\n        try {\r\n          await sendPasswordResetEmail(auth, user.email);\r\n          alert(\"E-posta gönderildi! Lütfen gelen kutunuzu kontrol edin.\");\r\n        } catch (error) {\r\n          alert(\"Hata: \" + error.message);\r\n        }\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\n// --- AUTH MODAL OLAYLARI ---\r\nif (loginBtn) loginBtn.onclick = () => modalBackdrop.classList.remove('is-hidden');\r\nif (closeBtn) closeBtn.onclick = () => modalBackdrop.classList.add('is-hidden');\r\nif (modalBackdrop) {\r\n  modalBackdrop.onclick = (e) => {\r\n    if(e.target === modalBackdrop) modalBackdrop.classList.add('is-hidden');\r\n  }\r\n}\r\n\r\nif (switchBtn) {\r\n  switchBtn.onclick = () => {\r\n    isLoginMode = !isLoginMode;\r\n    if (isLoginMode) {\r\n      authTitle.textContent = \"Login\";\r\n      submitBtn.textContent = \"Sign In\";\r\n      switchBtn.parentElement.innerHTML = `Don't have an account? <span id=\"auth-switch-btn\" style=\"color:orange;cursor:pointer\">Register here</span>`;\r\n    } else {\r\n      authTitle.textContent = \"Register\";\r\n      submitBtn.textContent = \"Sign Up\";\r\n      switchBtn.parentElement.innerHTML = `Already have an account? <span id=\"auth-switch-btn\" style=\"color:orange;cursor:pointer\">Login here</span>`;\r\n    }\r\n    // Yeni oluşturulan span'a tekrar event listener ekle\r\n    document.getElementById('auth-switch-btn').onclick = switchBtn.onclick; \r\n  };\r\n}\r\n\r\nif (authForm) {\r\n  authForm.onsubmit = async (e) => {\r\n    e.preventDefault();\r\n    const email = emailInput.value;\r\n    const password = passInput.value;\r\n    \r\n    submitBtn.disabled = true;\r\n    submitBtn.textContent = \"Please wait...\";\r\n\r\n    try {\r\n      if (isLoginMode) {\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n      } else {\r\n        await createUserWithEmailAndPassword(auth, email, password);\r\n      }\r\n      modalBackdrop.classList.add('is-hidden');\r\n      authForm.reset();\r\n    } catch (error) {\r\n      alert(\"Hata: \" + error.message);\r\n    } finally {\r\n      submitBtn.disabled = false;\r\n      submitBtn.textContent = isLoginMode ? \"Sign In\" : \"Sign Up\";\r\n    }\r\n  };\r\n}\r\n\r\n// --- ÇIKIŞ YAP BUTONU ---\r\nif (logoutBtn) {\r\n  logoutBtn.onclick = async (e) => {\r\n    e.preventDefault(); // Link olduğu için sayfa yenilenmesini durdur (manuel yapacağız)\r\n    await signOut(auth);\r\n    window.location.reload(); \r\n  };\r\n}\r\n\r\n// --- VERİTABANI FONKSİYONLARI ---\r\nexport async function getUserLibrary() {\r\n  const user = auth.currentUser;\r\n  if (user) {\r\n    const userRef = doc(db, \"users\", user.uid);\r\n    try {\r\n      const docSnap = await getDoc(userRef);\r\n      if (docSnap.exists()) return docSnap.data().library || [];\r\n    } catch (error) { console.error(error); }\r\n    return [];\r\n  } else {\r\n    return JSON.parse(localStorage.getItem('myLibrary')) || [];\r\n  }\r\n}\r\n\r\nexport async function addToLibrary(movieId) {\r\n  const user = auth.currentUser;\r\n  const id = Number(movieId);\r\n  if (user) {\r\n    const userRef = doc(db, \"users\", user.uid);\r\n    await setDoc(userRef, { library: arrayUnion(id) }, { merge: true });\r\n  } else {\r\n    const list = JSON.parse(localStorage.getItem('myLibrary')) || [];\r\n    if (!list.includes(id)) {\r\n      list.push(id);\r\n      localStorage.setItem('myLibrary', JSON.stringify(list));\r\n    }\r\n  }\r\n}\r\n\r\nexport async function removeFromLibrary(movieId) {\r\n  const user = auth.currentUser;\r\n  const id = Number(movieId);\r\n  if (user) {\r\n    const userRef = doc(db, \"users\", user.uid);\r\n    await updateDoc(userRef, { library: arrayRemove(id) });\r\n  } else {\r\n    let list = JSON.parse(localStorage.getItem('myLibrary')) || [];\r\n    list = list.filter(item => item !== id);\r\n    localStorage.setItem('myLibrary', JSON.stringify(list));\r\n  }\r\n}","// src/js/movies-data.js\r\n\r\nconst API_KEY = '362ee522f1af2dedac989b8df9cfb4eb';\r\nconst BASE_URL = 'https://api.themoviedb.org/3';\r\nconst IMG_URL = 'https://image.tmdb.org/t/p/w500';\r\nconst IMG_ORIGINAL_URL = 'https://image.tmdb.org/t/p/original';\r\n\r\n/* === GENEL FETCH FONKSİYONU (GÜNCELLENDİ) === */\r\n// 'lang' parametresi eklendi. Varsayılan 'en-US', ama 'null' gönderilirse dil filtresi kalkar.\r\nasync function fetchFromAPI(endpoint, params = {}, lang = 'en-US') {\r\n  const url = new URL(`${BASE_URL}${endpoint}`);\r\n  url.searchParams.append('api_key', API_KEY);\r\n  \r\n  // Eğer lang null değilse ekle (null gelirse eklemiyoruz, böylece hepsi geliyor)\r\n  if (lang) {\r\n    url.searchParams.append('language', lang); \r\n  }\r\n\r\n  for (const key in params) {\r\n    if (params[key]) url.searchParams.append(key, params[key]);\r\n  }\r\n\r\n  try {\r\n    const res = await fetch(url);\r\n    if (!res.ok) throw new Error(`API Error: ${res.status}`);\r\n    return await res.json();\r\n  } catch (err) {\r\n    console.error('API Request Failed:', err);\r\n    return null;\r\n  }\r\n}\r\n\r\n/* === DIŞA AÇILAN FONKSİYONLAR === */\r\n\r\nexport async function fetchPopularMovies(page = 1) {\r\n  return await fetchFromAPI('/movie/popular', { page });\r\n}\r\n\r\nexport async function fetchTrendingMovies(period = 'week', page = 1) {\r\n  return await fetchFromAPI(`/trending/movie/${period}`, { page });\r\n}\r\n\r\nexport async function fetchUpcomingMovies(page = 1) {\r\n  return await fetchFromAPI('/movie/upcoming', { page, region: 'US' });\r\n}\r\n\r\nexport async function searchMovies(query, page = 1, year = '') {\r\n  return await fetchFromAPI('/search/movie', {\r\n    query,\r\n    page,\r\n    primary_release_year: year,\r\n  });\r\n}\r\n\r\nexport async function fetchMovieDetails(id) {\r\n  return await fetchFromAPI(`/movie/${id}`);\r\n}\r\n\r\n// === GÜNCELLENEN KISIM: Video çekerken dili 'null' yapıyoruz ===\r\nexport async function fetchMovieVideos(id) {\r\n  return await fetchFromAPI(`/movie/${id}/videos`, {}, null);\r\n}\r\n\r\n/* === GÖRSEL YARDIMCILARI === */\r\nexport function getImageUrl(path) {\r\n  return path ? `${IMG_URL}${path}` : 'https://via.placeholder.com/500x750?text=No+Poster';\r\n}\r\n\r\nexport function getOriginalImageUrl(path) {\r\n  return path ? `${IMG_ORIGINAL_URL}${path}` : 'https://via.placeholder.com/1920x1080?text=No+Image';\r\n}\r\n\r\nexport async function fetchMovieProviders(id) {\r\n  return await fetchFromAPI(`/movie/${id}/watch/providers`);\r\n}","// src/js/modal.js\r\n\r\nimport { fetchMovieDetails, getImageUrl, fetchMovieProviders } from './movies-data.js';\r\n// YENİ: auth.js'den veritabanı fonksiyonlarını çekiyoruz\r\nimport { getUserLibrary, addToLibrary, removeFromLibrary } from './auth.js';\r\n\r\nexport function setupModal() {\r\n  const backdrop = document.querySelector('#movie-modal-backdrop');\r\n  if (!backdrop) return { openModal: () => {}, closeModal: () => {} };\r\n\r\n  const closeBtn = backdrop.querySelector('#modal-close-btn');\r\n  const poster = backdrop.querySelector('#modal-poster');\r\n  const title = backdrop.querySelector('#modal-title');\r\n  const voteAvg = backdrop.querySelector('#modal-vote-avg');\r\n  const voteCount = backdrop.querySelector('#modal-vote-count');\r\n  const popularity = backdrop.querySelector('#modal-popularity');\r\n  const genre = backdrop.querySelector('#modal-genre');\r\n  const description = backdrop.querySelector('#modal-description');\r\n  const addBtn = backdrop.querySelector('#modal-add-btn');\r\n\r\n  // --- EKSTRA SEÇİCİLER ---\r\n  const providersContainer = backdrop.querySelector('#modal-providers-container');\r\n  const providersList = backdrop.querySelector('#modal-providers-list');\r\n  const watchLink = backdrop.querySelector('#modal-watch-link');\r\n  const googleBtn = backdrop.querySelector('#modal-google-btn');\r\n\r\n  // NOT: Eski getLibrary ve saveLibrary fonksiyonlarını sildik.\r\n  // Artık auth.js içindeki fonksiyonları kullanacağız.\r\n\r\n  // === MODAL AÇMA FONKSİYONU ===\r\n  async function openModal(movieId) {\r\n    // 1. Film detaylarını çek\r\n    const movie = await fetchMovieDetails(movieId);\r\n    if (!movie) return;\r\n\r\n    // --- GOOGLE ARAMA BUTONU ---\r\n    if (googleBtn) {\r\n      googleBtn.onclick = () => {\r\n        const query = encodeURIComponent(`${movie.title} izle`); \r\n        window.open(`https://www.google.com/search?q=${query}`, '_blank');\r\n      };\r\n    }\r\n\r\n    // 2. Platform bilgilerini çek\r\n    const providersData = await fetchMovieProviders(movieId);\r\n    \r\n    // Modal içini görsel ve metinle doldur\r\n    if (poster) poster.src = getImageUrl(movie.poster_path);\r\n    if (title) title.textContent = movie.title.toUpperCase();\r\n    if (voteAvg) voteAvg.textContent = movie.vote_average.toFixed(1);\r\n    if (voteCount) voteCount.textContent = movie.vote_count;\r\n    if (popularity) popularity.textContent = movie.popularity.toFixed(1);\r\n    if (genre) genre.textContent = movie.genres.map((g) => g.name).join(', ') || 'N/A';\r\n    if (description) description.textContent = movie.overview || 'No description available.';\r\n\r\n    // --- PLATFORM MANTIĞI (NETFLIX, AMAZON VS.) ---\r\n    if (providersContainer && providersList) {\r\n      providersList.innerHTML = ''; // Temizle\r\n      providersContainer.classList.add('is-hidden'); // Gizle\r\n\r\n      const trData = providersData?.results?.TR; // Türkiye verisi\r\n\r\n      if (trData && trData.flatrate && trData.flatrate.length > 0) {\r\n        providersContainer.classList.remove('is-hidden');\r\n        \r\n        if (watchLink) watchLink.href = trData.link;\r\n\r\n        trData.flatrate.slice(0, 5).forEach(provider => {\r\n          const img = document.createElement('img');\r\n          img.src = `https://image.tmdb.org/t/p/original${provider.logo_path}`;\r\n          img.alt = provider.provider_name;\r\n          img.title = `Watch on ${provider.provider_name}`;\r\n          img.classList.add('provider-logo');\r\n          \r\n          // Platforma yönlendirme\r\n          img.onclick = () => {\r\n            const titleEncoded = encodeURIComponent(movie.title);\r\n            const pName = provider.provider_name.toLowerCase();\r\n            let targetUrl = '';\r\n\r\n            if (pName.includes('netflix')) {\r\n              targetUrl = `https://www.netflix.com/search?q=${titleEncoded}`;\r\n            } else if (pName.includes('amazon') || pName.includes('prime')) {\r\n              targetUrl = `https://www.primevideo.com/search/ref=atv_nb_sr?phrase=${titleEncoded}`;\r\n            } else if (pName.includes('disney')) {\r\n              targetUrl = `https://www.disneyplus.com/search?q=${titleEncoded}`;\r\n            } else if (pName.includes('apple')) {\r\n              targetUrl = `https://tv.apple.com/search?term=${titleEncoded}`;\r\n            } else if (pName.includes('blutv')) {\r\n              targetUrl = `https://www.blutv.com/arama?q=${titleEncoded}`;\r\n            } else if (pName.includes('mubi')) {\r\n              targetUrl = `https://mubi.com/tr/search/films?query=${titleEncoded}`;\r\n            } else {\r\n              targetUrl = trData.link; \r\n            }\r\n            window.open(targetUrl, '_blank');\r\n          };\r\n          providersList.appendChild(img);\r\n        });\r\n      }\r\n    }\r\n\r\n    // --- KÜTÜPHANE BUTONU (FIREBASE ENTEGRASYONU) ---\r\n    if (addBtn) {\r\n      const numericMovieId = Number(movie.id);\r\n      addBtn.dataset.id = numericMovieId;\r\n      \r\n      // Yükleniyor durumu\r\n      addBtn.textContent = \"Checking...\";\r\n      addBtn.disabled = true;\r\n      addBtn.classList.remove('btn-remove'); // Rengi sıfırla\r\n\r\n      // Firebase'den veya LocalStorage'dan durumu kontrol et\r\n      getUserLibrary().then(library => {\r\n        const exists = library.includes(numericMovieId);\r\n        \r\n        if (exists) {\r\n          addBtn.textContent = 'Remove from my library';\r\n          addBtn.classList.add('btn-remove'); // Kırmızı yap (CSS varsa)\r\n        } else {\r\n          addBtn.textContent = 'Add to my library';\r\n          addBtn.classList.remove('btn-remove');\r\n        }\r\n        addBtn.disabled = false; // Butonu aç\r\n      });\r\n    }\r\n\r\n    backdrop.classList.remove('is-hidden');\r\n    document.body.classList.add('modal-open');\r\n  }\r\n\r\n  function closeModal() {\r\n    backdrop.classList.add('is-hidden');\r\n    document.body.classList.remove('modal-open');\r\n  }\r\n\r\n  // --- EVENT LISTENERS ---\r\n  if (closeBtn) closeBtn.addEventListener('click', closeModal);\r\n  \r\n  backdrop.addEventListener('click', (e) => {\r\n    if (e.target === backdrop) closeModal();\r\n  });\r\n  \r\n  window.addEventListener('keydown', (e) => {\r\n    if (e.key === 'Escape' && !backdrop.classList.contains('is-hidden')) closeModal();\r\n  });\r\n\r\n  // --- KÜTÜPHANE EKLE/ÇIKAR TIKLAMA OLAYI ---\r\n  if (addBtn) {\r\n    // Not: addEventListener her açılışta birikmesin diye cloneNode yapılabilir \r\n    // ama setupModal bir kere çalıştığı için sorun yok.\r\n    addBtn.addEventListener('click', async () => {\r\n      const id = Number(addBtn.dataset.id);\r\n      if (!id) return;\r\n\r\n      // Butonu kilitle ve kullanıcıya bilgi ver\r\n      addBtn.disabled = true;\r\n      const originalText = addBtn.textContent;\r\n      addBtn.textContent = \"Processing...\";\r\n\r\n      try {\r\n        // Güncel listeyi çek\r\n        const library = await getUserLibrary();\r\n        const exists = library.includes(id);\r\n\r\n        if (exists) {\r\n          // Varsa Sil\r\n          await removeFromLibrary(id);\r\n          addBtn.textContent = 'Add to my library';\r\n          addBtn.classList.remove('btn-remove');\r\n        } else {\r\n          // Yoksa Ekle\r\n          await addToLibrary(id);\r\n          addBtn.textContent = 'Remove from my library';\r\n          addBtn.classList.add('btn-remove');\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Library Error:\", err);\r\n        addBtn.textContent = originalText; // Hata olursa eski metne dön\r\n        alert(\"Bir hata oluştu. Giriş yapmamış olabilir misiniz?\");\r\n      } finally {\r\n        addBtn.disabled = false; // Kilidi aç\r\n      }\r\n    });\r\n  }\r\n\r\n  return { openModal, closeModal };\r\n}","// src/js/team-modal.js\r\n\r\nexport function setupTeamModal() {\r\n  // Footer linkini seç (Birden fazla sayfada olabilir, sınıfına göre seçiyoruz)\r\n  const openBtn = document.querySelector('.footer-link'); \r\n  const backdrop = document.getElementById('team-modal-backdrop');\r\n  const closeBtn = document.getElementById('team-modal-close-btn');\r\n\r\n  // Eğer elementler sayfada yoksa (örn. başka bir sayfadaysak) dur.\r\n  if (!openBtn || !backdrop) return;\r\n\r\n  function openModal(e) {\r\n    e.preventDefault(); // Linkin yukarı atmasını engelle\r\n    backdrop.classList.remove('is-hidden'); // Modalı göster\r\n    document.body.classList.add('modal-open'); // Scrollu kilitle\r\n    window.addEventListener('keydown', onEscKeyPress);\r\n  }\r\n\r\n  function closeModal() {\r\n    backdrop.classList.add('is-hidden'); // Modalı gizle\r\n    document.body.classList.remove('modal-open'); // Scrollu aç\r\n    window.removeEventListener('keydown', onEscKeyPress);\r\n  }\r\n\r\n  function onEscKeyPress(e) {\r\n    if (e.code === 'Escape') {\r\n      closeModal();\r\n    }\r\n  }\r\n\r\n  // Olay Dinleyicileri\r\n  openBtn.addEventListener('click', openModal);\r\n  \r\n  if (closeBtn) closeBtn.addEventListener('click', closeModal);\r\n  \r\n  backdrop.addEventListener('click', (e) => {\r\n    if (e.target === backdrop) closeModal();\r\n  });\r\n}","// LOGO İLE AÇILAN MOBİL MENÜ – SADE VERSİYON\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const nav = document.querySelector(\".main-nav\");\r\n  const logo = document.querySelector(\".logo\");\r\n  const openBtn = document.querySelector(\".mobile-menu-btn\"); // Bazı sayfalarda var\r\n  let overlay = null;\r\n\r\n  if (!nav || !logo) return;\r\n\r\n  const isMobile = () => window.innerWidth <= 768;\r\n\r\n  function openNav(e) {\r\n    if (!isMobile()) return; // Desktop'ta çalışmasın\r\n    if (e) e.preventDefault();\r\n\r\n    // Overlay yoksa oluştur\r\n    if (!overlay) {\r\n      overlay = document.createElement(\"div\");\r\n      overlay.className = \"mobile-overlay\";\r\n      overlay.addEventListener(\"click\", closeNav);\r\n      document.body.appendChild(overlay);\r\n    }\r\n\r\n    nav.classList.add(\"is-open\");\r\n    document.body.classList.add(\"menu-open\");\r\n  }\r\n\r\n  function closeNav() {\r\n    nav.classList.remove(\"is-open\");\r\n    document.body.classList.remove(\"menu-open\");\r\n\r\n    if (overlay) {\r\n      overlay.removeEventListener(\"click\", closeNav);\r\n      overlay.remove();\r\n      overlay = null;\r\n    }\r\n  }\r\n\r\n  // Menü içi X butonu yoksa ekle\r\n  let closeBtn = nav.querySelector(\".mobile-nav-close\");\r\n  if (!closeBtn) {\r\n    closeBtn = document.createElement(\"button\");\r\n    closeBtn.type = \"button\";\r\n    \r\n    closeBtn.className = \"mobile-nav-close\";\r\n    closeBtn.innerHTML = \"&times;\";\r\n    nav.appendChild(closeBtn);\r\n  }\r\n  closeBtn.addEventListener(\"click\", closeNav);\r\n\r\n  // LOGO'ya tıklayınca menü aç\r\n  logo.addEventListener(\"click\", openNav);\r\n\r\n  // (Bazı sayfalarda varsa) hamburger butonu da açsın\r\n  if (openBtn) {\r\n    openBtn.addEventListener(\"click\", openNav);\r\n  }\r\n\r\n  // Menüdeki linklere tıklayınca menü kapansın\r\n  nav.querySelectorAll(\"a.nav-link\").forEach(link => {\r\n    link.addEventListener(\"click\", closeNav);\r\n  });\r\n\r\n  // Ekran genişlerse (desktop'a geçince) menüyü kapat\r\n  window.addEventListener(\"resize\", () => {\r\n    if (!isMobile()) {\r\n      closeNav();\r\n    }\r\n  });\r\n});\r\n","// Tema (Açık/Koyu Mod) Değiştirici\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  const themeToggle = document.getElementById('theme-toggle-checkbox');\r\n  const body = document.body;\r\n\r\n  if (!themeToggle) return; // Toggle butonu yoksa çalışma\r\n\r\n  // 1. Sayfa yüklendiğinde hafızadaki temayı kontrol et\r\n  const currentTheme = localStorage.getItem('theme');\r\n  if (currentTheme === 'light') {\r\n    body.classList.add('light-mode');\r\n    themeToggle.checked = true; // Toggle'ı 'açık' konuma getir\r\n  }\r\n  // (Varsayılan 'dark' olduğu için else gerekmez)\r\n\r\n  // 2. Toggle butonuna tıklandığında temayı değiştir\r\n  themeToggle.addEventListener('change', () => {\r\n    if (themeToggle.checked) {\r\n      // Açık Moda Geç\r\n      body.classList.add('light-mode');\r\n      localStorage.setItem('theme', 'light'); // Seçimi hafızaya kaydet\r\n    } else {\r\n      // Koyu Moda Geç\r\n      body.classList.remove('light-mode');\r\n      localStorage.setItem('theme', 'dark'); // Seçimi hafızaya kaydet\r\n    }\r\n  });\r\n});","// src/js/main.js\r\n\r\n// === 1. IMPORTLAR ===\r\nimport './auth.js'; \r\nimport { setupModal } from './modal.js';\r\nimport { setupTeamModal } from './team-modal.js';\r\nimport './mobile-nav.js';\r\nimport './theme-toggle.js';\r\n\r\n// === 2. GOOGLE TRANSLATE ENTEGRASYONU ===\r\nconst addGoogleScript = () => {\r\n  if (document.querySelector('script[src*=\"translate.google.com\"]')) return;\r\n  const script = document.createElement('script');\r\n  script.type = 'text/javascript';\r\n  script.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';\r\n  document.body.appendChild(script);\r\n};\r\n\r\nwindow.googleTranslateElementInit = function() {\r\n\r\n  // HTML'deki bütün dilleri otomatik al\r\n  const langs = [...document.querySelectorAll('.lang-opt')].map(el => el.dataset.val);\r\n\r\n  new google.translate.TranslateElement({\r\n    pageLanguage: 'en',\r\n    includedLanguages: langs.join(','), \r\n    autoDisplay: false\r\n  }, 'google_translate_element');\r\n};\r\n\r\nfunction changeLanguage(langCode) {\r\n  const cookieValue = `/auto/${langCode}`;\r\n  document.cookie = `googtrans=${cookieValue}; path=/; domain=${window.location.hostname}`;\r\n  document.cookie = `googtrans=${cookieValue}; path=/;`; \r\n  window.location.reload();\r\n}\r\n\r\naddGoogleScript();\r\n\r\n// === 3. DOM YÜKLENDİKTEN SONRA ===\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  \r\n  // --- Modüllerin Kurulumu ---\r\n  const { openModal } = setupModal();\r\n  window.openMovieModal = openModal;\r\n  setupTeamModal();\r\n\r\n  // --- Sayfa Yönlendirme (Routing) ---\r\n  const path = window.location.pathname;\r\n  let moduleName = null;\r\n\r\n  if (path.includes('catalog.html')) {\r\n    moduleName = 'catalog.js';\r\n  } else if (path.includes('my-library.html')) {\r\n    moduleName = 'my-library.js';\r\n  } else if (path === '/' || path.endsWith('index.html')) {\r\n    moduleName = 'index.js';\r\n  }\r\n\r\n  if (moduleName) {\r\n    import(`./${moduleName}`).catch(err => console.error(err));\r\n  }\r\n\r\n  // --- Navbar Aktif Link Ayarı ---\r\n  const navLinks = document.querySelectorAll('.nav-link');\r\n  navLinks.forEach(link => {\r\n    link.classList.remove('active');\r\n    const href = link.getAttribute('href');\r\n    if ((path === '/' || path.includes('index.html')) && href.includes('index.html')) link.classList.add('active');\r\n    else if (path.includes('catalog') && href.includes('catalog')) link.classList.add('active');\r\n    else if (path.includes('library') && href.includes('library')) link.classList.add('active');\r\n  });\r\n});\r\n\r\n// === 4. GLOBAL TIKLAMA YÖNETİMİ (EVENT DELEGATION) ===\r\ndocument.addEventListener('click', (e) => {\r\n  \r\n  // A. Hesabım Butonu\r\n  const accountBtn = e.target.closest('#btn-account');\r\n  if (accountBtn) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const dropdown = document.getElementById('account-dropdown');\r\n    if (dropdown) dropdown.classList.toggle('show');\r\n    return;\r\n  }\r\n\r\n  // B. Diller Butonu\r\n  const langBtn = e.target.closest('#btn-languages');\r\n  if (langBtn) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    const langList = document.getElementById('languages-list');\r\n    \r\n    if (langList) langList.classList.toggle('show');\r\n    langBtn.classList.toggle('open'); \r\n    return;\r\n  }\r\n\r\n  // C. Dil Seçenekleri\r\n  const langOpt = e.target.closest('.lang-opt');\r\n  if (langOpt) {\r\n    e.preventDefault();\r\n    const selectedLang = langOpt.getAttribute('data-val');\r\n    changeLanguage(selectedLang);\r\n    return;\r\n  }\r\n\r\n  // D. Dışarı Tıklama (Kapatma)\r\n  const dropdown = document.getElementById('account-dropdown');\r\n  const langList = document.getElementById('languages-list');\r\n  const langBtnRef = document.getElementById('btn-languages');\r\n\r\n  if (dropdown && dropdown.classList.contains('show')) {\r\n    if (!e.target.closest('#account-dropdown')) {\r\n      dropdown.classList.remove('show');\r\n      if (langList) langList.classList.remove('show');\r\n      if (langBtnRef) langBtnRef.classList.remove('open');\r\n    }\r\n  }\r\n});\r\n\r\n// === 5. TÜM DİL SEÇENEKLERİNE OTOMATİK İKON EKLEME ===\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  const langItems = document.querySelectorAll('.lang-opt');\r\n\r\n  langItems.forEach(item => {\r\n    // Eğer daha önce eklenmişse tekrar ekleme\r\n    if (item.querySelector('.lang-icon')) return;\r\n\r\n    const icon = document.createElement(\"i\");\r\n    icon.classList.add(\"fas\", \"fa-language\", \"lang-icon\");\r\n\r\n    // Iconu en başa koy\r\n    item.prepend(icon);\r\n  });\r\n});\r\n","// trailer-modal.js\r\nimport { fetchMovieVideos } from './movies-data.js';\r\n\r\n// === 1. TRAILER MODALINI AÇ ===\r\nexport function openTrailerModal(videoKey) {\r\n  const backdrop = document.getElementById('trailer-modal-backdrop');\r\n  if (!backdrop) return;\r\n\r\n  const iframe = document.getElementById('trailer-iframe');\r\n  const closeBtn = document.getElementById('trailer-modal-close-btn');\r\n\r\n  if (iframe) {\r\n    iframe.src = `https://www.youtube.com/embed/${videoKey}?autoplay=1&rel=0&showinfo=0`;\r\n  }\r\n\r\n  backdrop.classList.remove('is-hidden');\r\n  document.body.classList.add('modal-open');\r\n\r\n  if (closeBtn) closeBtn.onclick = () => closeTrailerModal();\r\n  backdrop.onclick = (e) => {\r\n    if (e.target === backdrop) closeTrailerModal();\r\n  };\r\n  const onEsc = (e) => {\r\n    if (e.key === 'Escape') {\r\n      closeTrailerModal();\r\n      window.removeEventListener('keydown', onEsc);\r\n    }\r\n  };\r\n  window.addEventListener('keydown', onEsc);\r\n}\r\n\r\n// === 2. TRAILER MODALINI KAPAT ===\r\nexport function closeTrailerModal() {\r\n  const backdrop = document.getElementById('trailer-modal-backdrop');\r\n  const iframe = document.getElementById('trailer-iframe');\r\n  if (!backdrop) return;\r\n\r\n  backdrop.classList.add('is-hidden');\r\n  document.body.classList.remove('modal-open');\r\n  if (iframe) iframe.src = '';\r\n}\r\n\r\n// === 3. \"WATCH TRAILER\" TIKLAMA YÖNETİCİSİ (GÜÇLENDİRİLMİŞ) ===\r\nexport async function onWatchTrailerClick(movieId) {\r\n  try {\r\n    const data = await fetchMovieVideos(movieId);\r\n    \r\n    // 1. Önce \"Trailer\" tipindeki videoyu ara\r\n    let trailer = data?.results?.find(\r\n      (v) => v.type === 'Trailer' && v.site === 'YouTube'\r\n    );\r\n\r\n    // 2. Eğer Trailer yoksa, \"Teaser\" ara (Yedek Plan)\r\n    if (!trailer) {\r\n      trailer = data?.results?.find(\r\n        (v) => v.type === 'Teaser' && v.site === 'YouTube'\r\n      );\r\n    }\r\n\r\n    if (trailer && trailer.key) {\r\n      openTrailerModal(trailer.key);\r\n    } else {\r\n      openTrailerErrorModal();\r\n    }\r\n  } catch (error) {\r\n    console.error('Fragman aranırken hata:', error);\r\n    openTrailerErrorModal();\r\n  }\r\n}\r\n\r\n// === 4. TRAILER HATA MODALINI AÇ ===\r\nexport function openTrailerErrorModal() {\r\n  const backdrop = document.getElementById('trailer-error-backdrop');\r\n  if (!backdrop) return;\r\n\r\n  const closeBtn = document.getElementById('trailer-error-close-btn');\r\n  backdrop.classList.remove('is-hidden');\r\n  document.body.classList.add('modal-open');\r\n\r\n  const closeErrorModal = () => {\r\n    backdrop.classList.add('is-hidden');\r\n    document.body.classList.remove('modal-open');\r\n  };\r\n\r\n  if (closeBtn) closeBtn.onclick = closeErrorModal;\r\n  backdrop.onclick = (e) => {\r\n    if (e.target === backdrop) closeErrorModal();\r\n  };\r\n  // ESC tuşu desteği\r\n  const onEsc = (e) => {\r\n      if (e.key === 'Escape') {\r\n          closeErrorModal();\r\n          window.removeEventListener('keydown', onEsc);\r\n      }\r\n  };\r\n  window.addEventListener('keydown', onEsc);\r\n}","// src/js/ui-helpers.js\r\n\r\nimport {\r\n  fetchMovieDetails,\r\n  fetchMovieVideos,\r\n  getImageUrl,\r\n  getOriginalImageUrl,\r\n} from \"./movies-data.js\";\r\nimport { openTrailerModal, openTrailerErrorModal } from \"./trailer-modal.js\";\r\n\r\n/* --- Yardımcılar --- */\r\nexport function getGenresText(genreData) {\r\n  // 1. Veri yoksa veya dizi değilse\r\n  if (!genreData || !Array.isArray(genreData) || genreData.length === 0) {\r\n    return \"N/A\";\r\n  }\r\n\r\n  const firstItem = genreData[0];\r\n\r\n  // 2. Detay sayfasından gelen veri (Obje dizisi: [{name: \"Action\"}, ...])\r\n  // İlk eleman bir obje mi ve içinde 'name' özelliği var mı diye kontrol ediyoruz.\r\n  if (typeof firstItem === \"object\" && firstItem !== null && firstItem.name) {\r\n    return genreData.map((g) => g.name).slice(0, 2).join(\", \");\r\n  }\r\n\r\n  // 3. Listeden gelen veri (ID dizisi: [28, 12, ...])\r\n  // İlk eleman bir sayı ise ID haritasını kullanıyoruz.\r\n  if (typeof firstItem === \"number\") {\r\n    const genreMap = {\r\n      28: \"Action\", 12: \"Adventure\", 16: \"Animation\", 35: \"Comedy\",\r\n      80: \"Crime\", 99: \"Documentary\", 18: \"Drama\", 10751: \"Family\",\r\n      14: \"Fantasy\", 36: \"History\", 27: \"Horror\", 10402: \"Music\",\r\n      9648: \"Mystery\", 10749: \"Romance\", 878: \"Sci-Fi\", 10770: \"TV Movie\",\r\n      53: \"Thriller\", 10752: \"War\", 37: \"Western\"\r\n    };\r\n    \r\n    const genres = genreData.map((id) => genreMap[id]).filter(Boolean);\r\n    // Eğer eşleşen tür bulunursa döndür, yoksa \"Other\" yaz\r\n    return genres.length > 0 ? genres.slice(0, 2).join(\", \") : \"Other\";\r\n  }\r\n\r\n  // 4. Hiçbiri değilse (Örn: String dizisi gelirse)\r\n  return \"N/A\";\r\n}\r\n\r\nexport function renderStars(vote) {\r\n  const stars = Math.round((vote || 0) / 2);\r\n  let html = \"\";\r\n  for (let i = 1; i <= 5; i++) {\r\n    html += `<i class=\"fa-star ${i <= stars ? \"fas active\" : \"far\"}\"></i>`;\r\n  }\r\n  return html;\r\n}\r\n\r\n/* --- Kart Render --- */\r\nexport function renderMovieCard(movie) {\r\n  // API'den bazen genres, bazen genre_ids gelebilir. İkisini de kontrol et.\r\n  const genreList = movie.genres || movie.genre_ids;\r\n  const year = movie.release_date ? new Date(movie.release_date).getFullYear() : \"N/A\";\r\n\r\n  return `\r\n    <div class=\"movie-card\" data-id=\"${movie.id}\">\r\n        <img src=\"${getImageUrl(movie.poster_path)}\" alt=\"${movie.title}\" class=\"movie-card-poster\" loading=\"lazy\">\r\n        <div class=\"movie-card-overlay\">\r\n            <h3 class=\"movie-title\">${movie.title}</h3>\r\n            <div class=\"movie-meta\">\r\n                <span class=\"movie-genre\">${getGenresText(genreList)} | ${year}</span>\r\n                <div class=\"movie-rating\">${renderStars(movie.vote_average)}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n  `;\r\n}\r\n\r\n/* --- Hero Güncelleme --- */\r\nexport async function updateHeroWithMovie(movieId, heroSection, heroContent) {\r\n  if (!heroSection || !heroContent) return;\r\n\r\n  try {\r\n    const movie = await fetchMovieDetails(movieId);\r\n    if (!movie) return;\r\n\r\n    const bg = getOriginalImageUrl(movie.backdrop_path || movie.poster_path);\r\n\r\n    heroSection.style.backgroundImage = `\r\n      linear-gradient(to right, \r\n        #111 0%, \r\n        rgba(17, 17, 17, 1) 30%, \r\n        rgba(17, 17, 17, 0.5) 50%, \r\n        transparent 100%),\r\n      url('${bg}')\r\n    `;\r\n\r\n    heroContent.innerHTML = `\r\n      <h1 class=\"hero-title\">${movie.title}</h1>\r\n      <div class=\"star-rating hero-stars\">\r\n        ${renderStars(movie.vote_average)}\r\n      </div>\r\n      <p class=\"hero-description\">${movie.overview || \"No description available.\"}</p>\r\n      <div class=\"hero-buttons\">\r\n        <button class=\"btn btn-primary\" id=\"hero-watch-trailer\" data-id=\"${movie.id}\">Watch Trailer</button>\r\n        <button class=\"btn btn-secondary\" id=\"hero-details-btn\" data-id=\"${movie.id}\">More details</button>\r\n      </div>\r\n    `;\r\n\r\n    // Event Listener'lar\r\n    const trailerBtn = heroContent.querySelector(\"#hero-watch-trailer\");\r\n    if (trailerBtn) {\r\n      trailerBtn.onclick = async (e) => {\r\n        e.preventDefault();\r\n        const id = e.target.dataset.id;\r\n        try {\r\n          const videos = await fetchMovieVideos(id);\r\n          const trailer = videos?.results?.find(v => v.type === \"Trailer\" && v.site === \"YouTube\");\r\n          if (trailer) openTrailerModal(trailer.key);\r\n          else openTrailerErrorModal();\r\n        } catch (err) {\r\n          console.error(err);\r\n          openTrailerErrorModal();\r\n        }\r\n      };\r\n    }\r\n\r\n    const detailBtn = heroContent.querySelector(\"#hero-details-btn\");\r\n    if (detailBtn) {\r\n      detailBtn.onclick = (e) => {\r\n        e.preventDefault();\r\n        const id = e.target.dataset.id;\r\n        if(window.openMovieModal) window.openMovieModal(id);\r\n      };\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error(\"Hero update error:\", error);\r\n  }\r\n}\r\n\r\n/* --- Upcoming Section Render --- */\r\nexport function renderUpcomingSection(movie, container) {\r\n  if (!movie || !container) return;\r\n\r\n  const releaseDate = new Date(movie.release_date).toLocaleDateString(\"en-US\");\r\n  const voteAvg = movie.vote_average ? movie.vote_average.toFixed(1) : \"N.A\";\r\n  const voteCount = movie.vote_count || 0;\r\n  const popularity = movie.popularity ? movie.popularity.toFixed(1) : \"N.A\";\r\n  const genres = getGenresText(movie.genres || movie.genre_ids); // Burada da her ikisini kontrol et\r\n  const imageUrl = getOriginalImageUrl(movie.backdrop_path || movie.poster_path);\r\n  const library = JSON.parse(localStorage.getItem(\"myLibrary\")) || [];\r\n  const isAdded = library.includes(Number(movie.id));\r\n  const btnText = isAdded ? \"Remove from my library\" : \"Add to my library\";\r\n\r\n  container.innerHTML = `\r\n    <div class=\"upcoming-image\">\r\n      <img src=\"${imageUrl}\" alt=\"${movie.title}\" loading=\"lazy\" />\r\n    </div>\r\n    <div class=\"upcoming-info\">\r\n      <h3>${movie.title}</h3>\r\n      <div class=\"movie-details-list\">\r\n        <div class=\"detail-item\">\r\n          <span class=\"detail-key\">Release date</span>\r\n          <span class=\"detail-history\">${releaseDate}</span>\r\n        </div>\r\n        <div class=\"detail-item\">\r\n          <span class=\"detail-key\">Vote / Votes</span>\r\n          <span class=\"detail-value\">\r\n            <span class=\"rating-badge\">${voteAvg}</span> / ${voteCount}\r\n          </span>\r\n        </div>\r\n        <div class=\"detail-item\">\r\n          <span class=\"detail-key\">Popularity</span>\r\n          <span class=\"detail-value\">${popularity}</span>\r\n        </div>\r\n        <div class=\"detail-item\">\r\n          <span class=\"detail-key\">Genre</span>\r\n          <span class=\"detail-value\">${genres}</span>\r\n        </div>\r\n      </div>\r\n      <h4>ABOUT</h4>\r\n      <p class=\"about-text\">${movie.overview || \"No description available.\"}</p>\r\n      <button class=\"btn btn-primary btn-add-library\" id=\"upcoming-add-btn\" data-id=\"${movie.id}\">\r\n        ${btnText}\r\n      </button>\r\n    </div>\r\n  `;\r\n\r\n  const btn = container.querySelector(\"#upcoming-add-btn\");\r\n  if (btn) {\r\n    btn.onclick = () => {\r\n      const currentLib = JSON.parse(localStorage.getItem(\"myLibrary\")) || [];\r\n      const movieId = Number(btn.dataset.id);\r\n      const index = currentLib.indexOf(movieId);\r\n\r\n      if (index > -1) {\r\n        currentLib.splice(index, 1);\r\n        btn.textContent = \"Add to my library\";\r\n      } else {\r\n        currentLib.push(movieId);\r\n        btn.textContent = \"Remove from my library\";\r\n      }\r\n      localStorage.setItem(\"myLibrary\", JSON.stringify(currentLib));\r\n    };\r\n  }\r\n}","export function showLoader() {\r\n  if (document.getElementById('loader')) return;\r\n  const loader = document.createElement('div');\r\n  loader.id = 'loader';\r\n  loader.style.cssText = `\r\n    position: fixed; inset: 0; background: rgba(0,0,0,0.7);\r\n    display: flex; justify-content: center; align-items: center;\r\n    z-index: 99999; color: white; font-size: 18px; flex-direction: column;\r\n    backdrop-filter: blur(3px);\r\n  `;\r\n  loader.innerHTML = `\r\n    <div class=\"spinner\" style=\"\r\n      border: 6px solid #333; border-top: 6px solid var(--primary-orange, orange);\r\n      border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; margin-bottom: 10px;\r\n    \"></div><p>Loading...</p>\r\n    <style>@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style>\r\n  `;\r\n  document.body.appendChild(loader);\r\n}\r\n\r\nexport function hideLoader() {\r\n  document.getElementById('loader')?.remove();\r\n}"],"file":"loader-DGX5Gv_s.js"}