import{initializeApp as Y}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";import{getAuth as K,signInWithEmailAndPassword as X,createUserWithEmailAndPassword as Q,signOut as Z,onAuthStateChanged as ee}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";import{getFirestore as te,doc as P,getDoc as ne,updateDoc as oe,arrayRemove as re,setDoc as ie,arrayUnion as se}from"https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const ae="modulepreload",ce=function(e){return"/my-project-cinemania/"+e},O={},le=function(t,o,n){let r=Promise.resolve();if(o&&o.length>0){let m=function(i){return Promise.all(i.map(u=>Promise.resolve(u).then(l=>({status:"fulfilled",value:l}),l=>({status:"rejected",reason:l}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");r=m(o.map(i=>{if(i=ce(i),i in O)return;O[i]=!0;const u=i.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${l}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":ae,u||(d.as="script"),d.crossOrigin="",d.href=i,c&&d.setAttribute("nonce",c),document.head.appendChild(d),u)return new Promise((h,k)=>{d.addEventListener("load",h),d.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${i}`)))})}))}function s(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return r.then(a=>{for(const c of a||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})},de={apiKey:"AIzaSyBmuibsjXBem9CN6pB-0nye7NryFJSya2g",authDomain:"filmorex.firebaseapp.com",projectId:"filmorex",storageBucket:"filmorex.firebasestorage.app",messagingSenderId:"962389606250",appId:"1:962389606250:web:4ba4c4fd8d70b077e56f13",measurementId:"G-XYT7Y5H7G9"},H=Y(de),w=K(H),U=te(H),_=document.getElementById("btn-login"),N=document.getElementById("btn-logout"),A=document.getElementById("user-email"),L=document.getElementById("auth-modal-backdrop"),R=document.getElementById("auth-close-btn"),q=document.getElementById("auth-form"),ue=document.getElementById("auth-email"),me=document.getElementById("auth-password"),D=document.getElementById("auth-title"),I=document.getElementById("auth-submit-btn"),$=document.getElementById("auth-switch-btn");let M=!0;async function F(){const e=w.currentUser;if(e){const t=P(U,"users",e.uid);try{const o=await ne(t);if(o.exists())return o.data().library||[]}catch(o){console.error("Veri çekme hatası:",o)}return[]}else return JSON.parse(localStorage.getItem("myLibrary"))||[]}async function pe(e){const t=w.currentUser,o=Number(e);if(t){const n=P(U,"users",t.uid);await ie(n,{library:se(o)},{merge:!0})}else{const n=JSON.parse(localStorage.getItem("myLibrary"))||[];n.includes(o)||(n.push(o),localStorage.setItem("myLibrary",JSON.stringify(n)))}}async function fe(e){const t=w.currentUser,o=Number(e);if(t){const n=P(U,"users",t.uid);await oe(n,{library:re(o)})}else{let n=JSON.parse(localStorage.getItem("myLibrary"))||[];n=n.filter(r=>r!==o),localStorage.setItem("myLibrary",JSON.stringify(n))}}_&&(_.onclick=()=>L.classList.remove("is-hidden"));R&&(R.onclick=()=>L.classList.add("is-hidden"));L&&(L.onclick=e=>{e.target===L&&L.classList.add("is-hidden")});$&&($.onclick=()=>{M=!M,M?(D.textContent="Login",I.textContent="Sign In",$.parentElement.innerHTML=`Don't have an account? <span id="auth-switch-btn" style="color:orange;cursor:pointer">Register here</span>`):(D.textContent="Register",I.textContent="Sign Up",$.parentElement.innerHTML='Already have an account? <span id="auth-switch-btn" style="color:orange;cursor:pointer">Login here</span>'),document.getElementById("auth-switch-btn").onclick=$.onclick});q&&(q.onsubmit=async e=>{e.preventDefault();const t=ue.value,o=me.value;I.disabled=!0,I.textContent="Please wait...";try{M?await X(w,t,o):await Q(w,t,o),L.classList.add("is-hidden"),q.reset()}catch(n){alert("Hata: "+n.message)}finally{I.disabled=!1,I.textContent=M?"Sign In":"Sign Up"}});N&&(N.onclick=async()=>{await Z(w),window.location.reload()});ee(w,e=>{e?(_.classList.add("is-hidden"),N.classList.remove("is-hidden"),A&&(A.textContent=e.email)):(_.classList.remove("is-hidden"),N.classList.add("is-hidden"),A&&(A.textContent=""))});const ye="362ee522f1af2dedac989b8df9cfb4eb",ge="https://api.themoviedb.org/3",he="https://image.tmdb.org/t/p/w500",ve="https://image.tmdb.org/t/p/original";async function E(e,t={}){const o=new URL(`${ge}${e}`);o.searchParams.append("api_key",ye),o.searchParams.append("language","en-US");for(const n in t)t[n]&&o.searchParams.append(n,t[n]);try{const n=await fetch(o);if(!n.ok)throw new Error(`API Error: ${n.status}`);return await n.json()}catch(n){return console.error("API Request Failed:",n),null}}async function $e(e=1){return await E("/movie/popular",{page:e})}async function Me(e="week",t=1){return await E(`/trending/movie/${e}`,{page:t})}async function Be(e=1){return await E("/movie/upcoming",{page:e,region:"US"})}async function Ce(e,t=1,o=""){return await E("/search/movie",{query:e,page:t,primary_release_year:o})}async function z(e){return await E(`/movie/${e}`)}async function be(e){return await E(`/movie/${e}/videos`)}function W(e){return e?`${he}${e}`:"https://via.placeholder.com/500x750?text=No+Poster"}function J(e){return e?`${ve}${e}`:"https://via.placeholder.com/1920x1080?text=No+Image"}async function Le(e){return await E(`/movie/${e}/watch/providers`)}function we(){const e=document.querySelector("#movie-modal-backdrop");if(!e)return{openModal:()=>{},closeModal:()=>{}};const t=e.querySelector("#modal-close-btn"),o=e.querySelector("#modal-poster"),n=e.querySelector("#modal-title"),r=e.querySelector("#modal-vote-avg"),s=e.querySelector("#modal-vote-count"),a=e.querySelector("#modal-popularity"),c=e.querySelector("#modal-genre"),m=e.querySelector("#modal-description"),i=e.querySelector("#modal-add-btn"),u=e.querySelector("#modal-providers-container"),l=e.querySelector("#modal-providers-list"),d=e.querySelector("#modal-watch-link"),h=e.querySelector("#modal-google-btn");async function k(y){const f=await z(y);if(!f)return;h&&(h.onclick=()=>{const p=encodeURIComponent(`${f.title} izle`);window.open(`https://www.google.com/search?q=${p}`,"_blank")});const C=await Le(y);if(o&&(o.src=W(f.poster_path)),n&&(n.textContent=f.title.toUpperCase()),r&&(r.textContent=f.vote_average.toFixed(1)),s&&(s.textContent=f.vote_count),a&&(a.textContent=f.popularity.toFixed(1)),c&&(c.textContent=f.genres.map(p=>p.name).join(", ")||"N/A"),m&&(m.textContent=f.overview||"No description available."),u&&l){l.innerHTML="",u.classList.add("is-hidden");const p=C?.results?.TR;p&&p.flatrate&&p.flatrate.length>0&&(u.classList.remove("is-hidden"),d&&(d.href=p.link),p.flatrate.slice(0,5).forEach(S=>{const v=document.createElement("img");v.src=`https://image.tmdb.org/t/p/original${S.logo_path}`,v.alt=S.provider_name,v.title=`Watch on ${S.provider_name}`,v.classList.add("provider-logo"),v.onclick=()=>{const x=encodeURIComponent(f.title),b=S.provider_name.toLowerCase();let g="";b.includes("netflix")?g=`https://www.netflix.com/search?q=${x}`:b.includes("amazon")||b.includes("prime")?g=`https://www.primevideo.com/search/ref=atv_nb_sr?phrase=${x}`:b.includes("disney")?g=`https://www.disneyplus.com/search?q=${x}`:b.includes("apple")?g=`https://tv.apple.com/search?term=${x}`:b.includes("blutv")?g=`https://www.blutv.com/arama?q=${x}`:b.includes("mubi")?g=`https://mubi.com/tr/search/films?query=${x}`:g=p.link,window.open(g,"_blank")},l.appendChild(v)}))}if(i){const p=Number(f.id);i.dataset.id=p,i.textContent="Checking...",i.disabled=!0,i.classList.remove("btn-remove"),F().then(S=>{S.includes(p)?(i.textContent="Remove from my library",i.classList.add("btn-remove")):(i.textContent="Add to my library",i.classList.remove("btn-remove")),i.disabled=!1})}e.classList.remove("is-hidden"),document.body.classList.add("modal-open")}function B(){e.classList.add("is-hidden"),document.body.classList.remove("modal-open")}return t&&t.addEventListener("click",B),e.addEventListener("click",y=>{y.target===e&&B()}),window.addEventListener("keydown",y=>{y.key==="Escape"&&!e.classList.contains("is-hidden")&&B()}),i&&i.addEventListener("click",async()=>{const y=Number(i.dataset.id);if(!y)return;i.disabled=!0;const f=i.textContent;i.textContent="Processing...";try{(await F()).includes(y)?(await fe(y),i.textContent="Add to my library",i.classList.remove("btn-remove")):(await pe(y),i.textContent="Remove from my library",i.classList.add("btn-remove"))}catch(C){console.error("Library Error:",C),i.textContent=f,alert("Bir hata oluştu. Giriş yapmamış olabilir misiniz?")}finally{i.disabled=!1}}),{openModal:k,closeModal:B}}function Ee(){const e=document.querySelector(".footer-link"),t=document.getElementById("team-modal-backdrop"),o=document.getElementById("team-modal-close-btn");if(!e||!t)return;function n(a){a.preventDefault(),t.classList.remove("is-hidden"),document.body.classList.add("modal-open"),window.addEventListener("keydown",s)}function r(){t.classList.add("is-hidden"),document.body.classList.remove("modal-open"),window.removeEventListener("keydown",s)}function s(a){a.code==="Escape"&&r()}e.addEventListener("click",n),o&&o.addEventListener("click",r),t.addEventListener("click",a=>{a.target===t&&r()})}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-nav"),t=document.querySelector(".logo"),o=document.querySelector(".mobile-menu-btn");let n=null;if(!e||!t)return;const r=()=>window.innerWidth<=768;function s(m){r()&&(m&&m.preventDefault(),n||(n=document.createElement("div"),n.className="mobile-overlay",n.addEventListener("click",a),document.body.appendChild(n)),e.classList.add("is-open"),document.body.classList.add("menu-open"))}function a(){e.classList.remove("is-open"),document.body.classList.remove("menu-open"),n&&(n.removeEventListener("click",a),n.remove(),n=null)}let c=e.querySelector(".mobile-nav-close");c||(c=document.createElement("button"),c.type="button",c.className="mobile-nav-close",c.innerHTML="&times;",e.appendChild(c)),c.addEventListener("click",a),t.addEventListener("click",s),o&&o.addEventListener("click",s),e.querySelectorAll("a.nav-link").forEach(m=>{m.addEventListener("click",a)}),window.addEventListener("resize",()=>{r()||a()})});document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("theme-toggle-checkbox"),t=document.body;if(!e)return;localStorage.getItem("theme")==="light"&&(t.classList.add("light-mode"),e.checked=!0),e.addEventListener("change",()=>{e.checked?(t.classList.add("light-mode"),localStorage.setItem("theme","light")):(t.classList.remove("light-mode"),localStorage.setItem("theme","dark"))})});document.addEventListener("DOMContentLoaded",()=>{const{openModal:e}=we();window.openMovieModal=e,Ee();const t=window.location.pathname;let o=null;t.includes("catalog.html")?o="catalog.js":t.includes("my-library.html")?o="my-library.js":(t==="/"||t.endsWith("index.html"))&&(o="index.js"),document.querySelectorAll(".nav-link").forEach(r=>{r.classList.remove("active");const s=r.getAttribute("href");((t==="/"||t.includes("index.html"))&&s.includes("index.html")||t.includes("catalog")&&s.includes("catalog")||t.includes("library")&&s.includes("library"))&&r.classList.add("active")}),o&&le(()=>import(`./${o}`),[]).then(()=>console.log(`${o} yüklendi.`)).catch(r=>console.error(`${o} yüklenirken hata:`,r))});function ke(e){const t=document.getElementById("trailer-modal-backdrop");if(!t)return;const o=document.getElementById("trailer-iframe"),n=document.getElementById("trailer-modal-close-btn");o&&(o.src=`https://www.youtube.com/embed/${e}?autoplay=1&rel=0&showinfo=0`),t.classList.remove("is-hidden"),document.body.classList.add("modal-open"),n&&(n.onclick=()=>T()),t.onclick=s=>{s.target===t&&T()};const r=s=>{s.key==="Escape"&&(T(),window.removeEventListener("keydown",r))};window.addEventListener("keydown",r)}function T(){const e=document.getElementById("trailer-modal-backdrop"),t=document.getElementById("trailer-iframe");e&&(e.classList.add("is-hidden"),document.body.classList.remove("modal-open"),t&&(t.src=""))}function j(){const e=document.getElementById("trailer-error-backdrop");if(!e)return;const t=document.getElementById("trailer-error-close-btn");e.classList.remove("is-hidden"),document.body.classList.add("modal-open");const o=()=>{e.classList.add("is-hidden"),document.body.classList.remove("modal-open"),window.removeEventListener("keydown",n)};t&&(t.onclick=o),e.onclick=r=>{r.target===e&&o()};const n=r=>{r.key==="Escape"&&o()};window.addEventListener("keydown",n)}function G(e){if(!e)return"N/A";if(Array.isArray(e)&&e.length>0&&typeof e[0]=="object")return e.map(o=>o.name).slice(0,2).join(", ");const t={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Sci-Fi",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western"};return Array.isArray(e)?e.map(n=>t[n]).filter(Boolean).slice(0,2).join(", ")||"Other":"N/A"}function V(e){const t=Math.round((e||0)/2);let o="";for(let n=1;n<=5;n++)o+=`<i class="fa-star ${n<=t?"fas active":"far"}"></i>`;return o}function Ae(e){const t=e.genres||e.genre_ids,o=e.release_date?new Date(e.release_date).getFullYear():"N/A";return`
    <div class="movie-card" data-id="${e.id}">
        <img src="${W(e.poster_path)}" alt="${e.title}" class="movie-card-poster" loading="lazy">
        <div class="movie-card-overlay">
            <h3 class="movie-title">${e.title}</h3>
            <div class="movie-meta">
                <span class="movie-genre">${G(t)} | ${o}</span>
                <div class="movie-rating">${V(e.vote_average)}</div>
            </div>
        </div>
    </div>
  `}async function _e(e,t,o){if(!(!t||!o))try{const n=await z(e);if(!n)return;const r=J(n.backdrop_path||n.poster_path);t.style.backgroundImage=`
      linear-gradient(to right, 
        #111 0%, 
        rgba(17, 17, 17, 1) 30%, 
        rgba(17, 17, 17, 0.5) 50%, 
        transparent 100%),
      url('${r}')
    `,o.innerHTML=`
      <h1 class="hero-title">${n.title}</h1>
      <div class="star-rating hero-stars">
        ${V(n.vote_average)}
      </div>
      <p class="hero-description">${n.overview||"No description available."}</p>
      <div class="hero-buttons">
        <button class="btn btn-primary" id="hero-watch-trailer" data-id="${n.id}">Watch Trailer</button>
        <button class="btn btn-secondary" id="hero-details-btn" data-id="${n.id}">More details</button>
      </div>
    `;const s=o.querySelector("#hero-watch-trailer");s&&(s.onclick=async c=>{c.preventDefault();const m=c.target.dataset.id;try{const u=(await be(m))?.results?.find(l=>l.type==="Trailer"&&l.site==="YouTube");u?ke(u.key):j()}catch(i){console.error(i),j()}});const a=o.querySelector("#hero-details-btn");a&&(a.onclick=c=>{c.preventDefault();const m=c.target.dataset.id;window.openMovieModal&&window.openMovieModal(m)})}catch(n){console.error("Hero update error:",n)}}function Ne(e,t){if(!e||!t)return;const o=new Date(e.release_date).toLocaleDateString("en-US"),n=e.vote_average?e.vote_average.toFixed(1):"N.A",r=e.vote_count||0,s=e.popularity?e.popularity.toFixed(1):"N.A",a=G(e.genre_ids),c=J(e.backdrop_path||e.poster_path),u=(JSON.parse(localStorage.getItem("myLibrary"))||[]).includes(Number(e.id))?"Remove from my library":"Add to my library";t.innerHTML=`
    <div class="upcoming-image">
      <img src="${c}" alt="${e.title}" loading="lazy" />
    </div>
    <div class="upcoming-info">
      <h3>${e.title}</h3>
      <div class="movie-details-list">
        <div class="detail-item">
          <span class="detail-key">Release date</span>
          <span class="detail-history">${o}</span>
        </div>
        <div class="detail-item">
          <span class="detail-key">Vote / Votes</span>
          <span class="detail-value">
            <span class="rating-badge">${n}</span> / ${r}
          </span>
        </div>
        <div class="detail-item">
          <span class="detail-key">Popularity</span>
          <span class="detail-value">${s}</span>
        </div>
        <div class="detail-item">
          <span class="detail-key">Genre</span>
          <span class="detail-value">${a}</span>
        </div>
      </div>
      <h4>ABOUT</h4>
      <p class="about-text">${e.overview||"No description available."}</p>
      <button class="btn btn-primary btn-add-library" id="upcoming-add-btn" data-id="${e.id}">
        ${u}
      </button>
    </div>
  `;const l=t.querySelector("#upcoming-add-btn");l&&(l.onclick=()=>{const d=JSON.parse(localStorage.getItem("myLibrary"))||[],h=Number(l.dataset.id),k=d.indexOf(h);k>-1?(d.splice(k,1),l.textContent="Add to my library"):(d.push(h),l.textContent="Remove from my library"),localStorage.setItem("myLibrary",JSON.stringify(d))})}function qe(){if(document.getElementById("loader"))return;const e=document.createElement("div");e.id="loader",e.style.cssText=`
    position: fixed; inset: 0; background: rgba(0,0,0,0.7);
    display: flex; justify-content: center; align-items: center;
    z-index: 99999; color: white; font-size: 18px; flex-direction: column;
    backdrop-filter: blur(3px);
  `,e.innerHTML=`
    <div class="spinner" style="
      border: 6px solid #333; border-top: 6px solid var(--primary-orange, orange);
      border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; margin-bottom: 10px;
    "></div><p>Loading...</p>
    <style>@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style>
  `,document.body.appendChild(e)}function Te(){document.getElementById("loader")?.remove()}export{w as a,Me as b,Be as c,Ne as d,Ce as e,z as f,F as g,Te as h,$e as i,Ae as r,qe as s,_e as u};
//# sourceMappingURL=loader-NddkUy2j.js.map
