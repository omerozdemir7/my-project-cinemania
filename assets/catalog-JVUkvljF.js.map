{"version":3,"file":"catalog-JVUkvljF.js","sources":["../../src/js/pagination.js","../../src/js/catalog.js"],"sourcesContent":["/**\r\n * Sayfalama (pagination) component'ini oluşturur ve DOM'a basar.\r\n * @param {HTMLElement} container - Butonların basılacağı div\r\n * @param {number} totalPages - Toplam sayfa sayısı\r\n * @param {number} currentPage - Aktif sayfa\r\n * @param {Function} onPageChange - Sayfa değiştiğinde çağrılacak fonksiyon (yeni sayfa numarasını alır)\r\n */\r\nexport function setupPagination(\r\n  container,\r\n  totalPages,\r\n  currentPage,\r\n  onPageChange\r\n) {\r\n  if (!container || totalPages <= 1) {\r\n    if (container) container.innerHTML = ''; // Sayfalama gerekmiyorsa temizle\r\n    return;\r\n  }\r\n\r\n  container.innerHTML = '';\r\n  const maxButtons = 5; // Ekranda görünecek maks sayfa butonu\r\n\r\n  // Hangi sayfa numarasından başlayacağını hesapla\r\n  let start = Math.max(currentPage - 2, 1);\r\n  let end = Math.min(start + maxButtons - 1, totalPages);\r\n\r\n  // Eğer sona yaklaşıldıysa (örn. 50 sayfa varken 49. sayfadaysan),\r\n  // 46, 47, 48, 49, 50 göstermek için başlangıcı ayarla\r\n  if (end - start < maxButtons - 1) {\r\n    start = Math.max(end - maxButtons + 1, 1);\r\n  }\r\n\r\n  // --- 1. Sol Ok (Geri) ---\r\n  const prev = document.createElement('button');\r\n  prev.className = 'pagination-arrow';\r\n  prev.innerHTML = '&laquo;'; // «\r\n  prev.disabled = currentPage === 1; // İlk sayfadaysa pasif\r\n  prev.addEventListener('click', () => onPageChange(currentPage - 1));\r\n  container.appendChild(prev);\r\n\r\n  // --- 2. Sayfa Numaraları ---\r\n\r\n  // Gerekirse '1 ...' ekle\r\n  if (start > 1) {\r\n    container.appendChild(createPageButton(1, onPageChange));\r\n    if (start > 2) {\r\n      container.appendChild(createDots());\r\n    }\r\n  }\r\n\r\n  // Ana sayfa butonları (örn. 10, 11, 12, 13, 14)\r\n  for (let i = start; i <= end; i++) {\r\n    const btn = createPageButton(i, onPageChange, i === currentPage);\r\n    container.appendChild(btn);\r\n  }\r\n\r\n  // Gerekirse '... 50' ekle\r\n  if (end < totalPages) {\r\n    if (end < totalPages - 1) {\r\n      container.appendChild(createDots());\r\n    }\r\n    container.appendChild(createPageButton(totalPages, onPageChange));\r\n  }\r\n\r\n  // --- 3. Sağ Ok (İleri) ---\r\n  const next = document.createElement('button');\r\n  next.className = 'pagination-arrow';\r\n  next.innerHTML = '&raquo;'; // »\r\n  next.disabled = currentPage === totalPages; // Son sayfadaysa pasif\r\n  next.addEventListener('click', () => onPageChange(currentPage + 1));\r\n  container.appendChild(next);\r\n}\r\n\r\n// --- Yardımcı Fonksiyonlar (pagination.js için) ---\r\n\r\n/**\r\n * Tıklanabilir bir sayfa butonu oluşturur\r\n * @private\r\n */\r\nfunction createPageButton(page, onClick, isActive = false) {\r\n  const btn = document.createElement('button');\r\n  btn.className = 'pagination-btn';\r\n  if (isActive) btn.classList.add('active');\r\n  btn.textContent = page;\r\n  btn.addEventListener('click', () => onClick(page));\r\n  return btn;\r\n}\r\n\r\n/**\r\n * '...' elementini oluşturur\r\n * @private\r\n */\r\nfunction createDots() {\r\n  const dots = document.createElement('span');\r\n  dots.className = 'pagination-dots';\r\n  dots.textContent = '...';\r\n  return dots;\r\n}","// src/js/catalog.js\r\nimport {\r\n  searchMovies,\r\n  fetchPopularMovies,\r\n} from './movies-data.js';\r\nimport { setupPagination } from './pagination.js';\r\nimport { showLoader, hideLoader } from './loader.js';\r\nimport { renderMovieCard, updateHeroWithMovie } from './ui-helpers.js';\r\n\r\nconst initCatalog = async () => {\r\n  const form = document.getElementById('search-form');\r\n  const input = document.getElementById('search-input');\r\n  const movieGrid = document.getElementById('movie-grid');\r\n  const paginationContainer = document.querySelector('.pagination');\r\n  const heroSection = document.getElementById('catalog-hero');\r\n  const heroContent = document.getElementById('catalog-hero-content');\r\n\r\n  // --- YENİ DROPDOWN ELEMENTLERİ ---\r\n  const dropdown = document.getElementById('year-dropdown');\r\n  const dropdownHeader = document.getElementById('dropdown-header');\r\n  const dropdownList = document.getElementById('dropdown-list');\r\n  const selectedYearSpan = document.getElementById('selected-year');\r\n  const yearInput = document.getElementById('year-input'); // Gizli input\r\n\r\n  if (!movieGrid) return; // Katalog sayfasında değilsek dur\r\n\r\n  // --- YILLARI LİSTEYE DOLDURMA ---\r\n  const currentYear = new Date().getFullYear();\r\n\r\n  if (dropdownList) {\r\n    // 1. En başa \"Year (All)\" seçeneği ekle (Sıfırlamak için)\r\n    const resetLi = document.createElement('li');\r\n    resetLi.classList.add('dropdown-item'); // CSS'teki sınıf\r\n    resetLi.textContent = \"Year\";\r\n    \r\n    resetLi.onclick = () => {\r\n      if (yearInput) yearInput.value = \"\"; // Değeri temizle\r\n      if (selectedYearSpan) {\r\n        selectedYearSpan.textContent = \"Year\";\r\n        selectedYearSpan.style.color = \"\"; // Rengi sıfırla\r\n      }\r\n      closeDropdown();\r\n    };\r\n    dropdownList.appendChild(resetLi);\r\n\r\n    // 2. Yılları döngü ile ekle\r\n    for (let y = currentYear; y >= 1950; y--) {\r\n      const li = document.createElement('li');\r\n      li.classList.add('dropdown-item'); // CSS'teki sınıf\r\n      li.textContent = y;\r\n      \r\n      // Yıla tıklanınca ne olacak?\r\n      li.onclick = () => {\r\n        if (yearInput) yearInput.value = y; // Gizli inputa yaz\r\n        if (selectedYearSpan) {\r\n          selectedYearSpan.textContent = y; // Ekranda göster\r\n          selectedYearSpan.style.color = \"var(--primary-orange)\"; // Seçili olduğunu belli et\r\n        }\r\n        closeDropdown();\r\n      };\r\n      \r\n      dropdownList.appendChild(li);\r\n    }\r\n  }\r\n\r\n  // --- DROPDOWN AÇMA / KAPAMA MANTIĞI ---\r\n  function toggleDropdown() {\r\n    if (dropdown) dropdown.classList.toggle('active'); // Ok işaretini döndürür\r\n    if (dropdownList) dropdownList.classList.toggle('is-hidden'); // Listeyi açar/kapatır\r\n  }\r\n\r\n  function closeDropdown() {\r\n    if (dropdown) dropdown.classList.remove('active');\r\n    if (dropdownList) dropdownList.classList.add('is-hidden');\r\n  }\r\n\r\n  // Header'a tıklayınca aç/kapa\r\n  if (dropdownHeader) {\r\n    dropdownHeader.addEventListener('click', (e) => {\r\n      e.stopPropagation(); // Tıklamanın sayfa geneline yayılmasını engelle\r\n      toggleDropdown();\r\n    });\r\n  }\r\n\r\n  // Sayfada boş yere tıklayınca kapat\r\n  document.addEventListener('click', (e) => {\r\n    if (dropdown && !dropdown.contains(e.target)) {\r\n      closeDropdown();\r\n    }\r\n  });\r\n\r\n  // --- DEĞİŞKENLER ---\r\n  let currentPage = 1;\r\n  let lastQuery = '';\r\n  let lastYear = '';\r\n  let totalPages = 1;\r\n\r\n  // --- BAŞLANGIÇ FİLMLERİ ---\r\n  async function loadInitialMovies() {\r\n    showLoader();\r\n    const data = await fetchPopularMovies(1);\r\n    hideLoader();\r\n\r\n    if (data?.results?.length) {\r\n      renderMovies(data.results);\r\n      if (data.results[0]) {\r\n        await updateHeroWithMovie(data.results[0].id, heroSection, heroContent);\r\n      }\r\n    }\r\n  }\r\n\r\n  // --- ARAMA İŞLEMİ ---\r\n  if (form) {\r\n    form.addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n      const query = input.value.trim();\r\n      \r\n      // DİKKAT: Artık select yok, gizli input'tan değeri alıyoruz\r\n      const year = yearInput ? yearInput.value : ''; \r\n\r\n      if (!query) return;\r\n\r\n      currentPage = 1;\r\n      lastQuery = query;\r\n      lastYear = year;\r\n      \r\n      // Arama yaparken dropdown açıksa kapatalım\r\n      closeDropdown(); \r\n      \r\n      await fetchAndRenderMovies(query, year, currentPage);\r\n    });\r\n  }\r\n\r\n  async function fetchAndRenderMovies(query, year, page) {\r\n    showLoader();\r\n    const data = await searchMovies(query, page, year);\r\n    hideLoader();\r\n\r\n if (!data?.results?.length) {\r\n      // Görseldeki tasarıma uygun HTML yapısı\r\n      movieGrid.innerHTML = `\r\n        <div class=\"no-results-container\">\r\n          <h2 class=\"no-results-title\">OOPS...</h2>\r\n          <h3 class=\"no-results-text\">We are very sorry!</h3>\r\n          <h3 class=\"no-results-text\">We don’t have any results matching your search.</h3>\r\n        </div>\r\n      `;\r\n      paginationContainer.innerHTML = '';\r\n      heroContent.innerHTML = '';\r\n      heroSection.style.backgroundImage = 'none';\r\n      return;\r\n    }\r\n    totalPages = data.total_pages;\r\n    renderMovies(data.results);\r\n\r\n    if (data.results[0]) {\r\n      await updateHeroWithMovie(data.results[0].id, heroSection, heroContent);\r\n    }\r\n\r\n    setupPagination(paginationContainer, totalPages, page, (newPage) => {\r\n      currentPage = newPage;\r\n      fetchAndRenderMovies(lastQuery, lastYear, newPage);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    });\r\n  }\r\n\r\n  function renderMovies(list) {\r\n    movieGrid.innerHTML = list.map((m) => renderMovieCard(m)).join('');\r\n  }\r\n\r\n  movieGrid.addEventListener('click', (e) => {\r\n    const card = e.target.closest('.movie-card');\r\n    if (card && card.dataset.id) {\r\n      updateHeroWithMovie(card.dataset.id, heroSection, heroContent);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  });\r\n\r\n  await loadInitialMovies();\r\n};\r\n\r\ninitCatalog();"],"names":["setupPagination","container","totalPages","currentPage","onPageChange","maxButtons","start","end","prev","createPageButton","createDots","i","btn","next","page","onClick","isActive","dots","initCatalog","form","input","movieGrid","paginationContainer","heroSection","heroContent","dropdown","dropdownHeader","dropdownList","selectedYearSpan","yearInput","currentYear","resetLi","closeDropdown","y","li","toggleDropdown","lastQuery","lastYear","loadInitialMovies","showLoader","data","fetchPopularMovies","hideLoader","renderMovies","updateHeroWithMovie","query","year","fetchAndRenderMovies","searchMovies","newPage","list","m","renderMovieCard","card"],"mappings":"yRAOO,SAASA,EACdC,EACAC,EACAC,EACAC,EACA,CACA,GAAI,CAACH,GAAaC,GAAc,EAAG,CAC7BD,IAAWA,EAAU,UAAY,IACrC,MACF,CAEAA,EAAU,UAAY,GACtB,MAAMI,EAAa,EAGnB,IAAIC,EAAQ,KAAK,IAAIH,EAAc,EAAG,CAAC,EACnCI,EAAM,KAAK,IAAID,EAAQD,EAAa,EAAGH,CAAU,EAIjDK,EAAMD,EAAQD,EAAa,IAC7BC,EAAQ,KAAK,IAAIC,EAAMF,EAAa,EAAG,CAAC,GAI1C,MAAMG,EAAO,SAAS,cAAc,QAAQ,EAC5CA,EAAK,UAAY,mBACjBA,EAAK,UAAY,UACjBA,EAAK,SAAWL,IAAgB,EAChCK,EAAK,iBAAiB,QAAS,IAAMJ,EAAaD,EAAc,CAAC,CAAC,EAClEF,EAAU,YAAYO,CAAI,EAKtBF,EAAQ,IACVL,EAAU,YAAYQ,EAAiB,EAAGL,CAAY,CAAC,EACnDE,EAAQ,GACVL,EAAU,YAAYS,EAAU,CAAE,GAKtC,QAASC,EAAIL,EAAOK,GAAKJ,EAAKI,IAAK,CACjC,MAAMC,EAAMH,EAAiBE,EAAGP,EAAcO,IAAMR,CAAW,EAC/DF,EAAU,YAAYW,CAAG,CAC3B,CAGIL,EAAML,IACJK,EAAML,EAAa,GACrBD,EAAU,YAAYS,EAAU,CAAE,EAEpCT,EAAU,YAAYQ,EAAiBP,EAAYE,CAAY,CAAC,GAIlE,MAAMS,EAAO,SAAS,cAAc,QAAQ,EAC5CA,EAAK,UAAY,mBACjBA,EAAK,UAAY,UACjBA,EAAK,SAAWV,IAAgBD,EAChCW,EAAK,iBAAiB,QAAS,IAAMT,EAAaD,EAAc,CAAC,CAAC,EAClEF,EAAU,YAAYY,CAAI,CAC5B,CAQA,SAASJ,EAAiBK,EAAMC,EAASC,EAAW,GAAO,CACzD,MAAMJ,EAAM,SAAS,cAAc,QAAQ,EAC3C,OAAAA,EAAI,UAAY,iBACZI,GAAUJ,EAAI,UAAU,IAAI,QAAQ,EACxCA,EAAI,YAAcE,EAClBF,EAAI,iBAAiB,QAAS,IAAMG,EAAQD,CAAI,CAAC,EAC1CF,CACT,CAMA,SAASF,GAAa,CACpB,MAAMO,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAAA,EAAK,UAAY,kBACjBA,EAAK,YAAc,MACZA,CACT,CCvFA,MAAMC,EAAc,SAAY,CAC9B,MAAMC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAQ,SAAS,eAAe,cAAc,EAC9CC,EAAY,SAAS,eAAe,YAAY,EAChDC,EAAsB,SAAS,cAAc,aAAa,EAC1DC,EAAc,SAAS,eAAe,cAAc,EACpDC,EAAc,SAAS,eAAe,sBAAsB,EAG5DC,EAAW,SAAS,eAAe,eAAe,EAClDC,EAAiB,SAAS,eAAe,iBAAiB,EAC1DC,EAAe,SAAS,eAAe,eAAe,EACtDC,EAAmB,SAAS,eAAe,eAAe,EAC1DC,EAAY,SAAS,eAAe,YAAY,EAEtD,GAAI,CAACR,EAAW,OAGhB,MAAMS,EAAc,IAAI,KAAI,EAAG,YAAW,EAE1C,GAAIH,EAAc,CAEhB,MAAMI,EAAU,SAAS,cAAc,IAAI,EAC3CA,EAAQ,UAAU,IAAI,eAAe,EACrCA,EAAQ,YAAc,OAEtBA,EAAQ,QAAU,IAAM,CAClBF,IAAWA,EAAU,MAAQ,IAC7BD,IACFA,EAAiB,YAAc,OAC/BA,EAAiB,MAAM,MAAQ,IAEjCI,GACF,EACAL,EAAa,YAAYI,CAAO,EAGhC,QAASE,EAAIH,EAAaG,GAAK,KAAMA,IAAK,CACxC,MAAMC,EAAK,SAAS,cAAc,IAAI,EACtCA,EAAG,UAAU,IAAI,eAAe,EAChCA,EAAG,YAAcD,EAGjBC,EAAG,QAAU,IAAM,CACbL,IAAWA,EAAU,MAAQI,GAC7BL,IACFA,EAAiB,YAAcK,EAC/BL,EAAiB,MAAM,MAAQ,yBAEjCI,GACF,EAEAL,EAAa,YAAYO,CAAE,CAC7B,CACF,CAGA,SAASC,GAAiB,CACpBV,GAAUA,EAAS,UAAU,OAAO,QAAQ,EAC5CE,GAAcA,EAAa,UAAU,OAAO,WAAW,CAC7D,CAEA,SAASK,GAAgB,CACnBP,GAAUA,EAAS,UAAU,OAAO,QAAQ,EAC5CE,GAAcA,EAAa,UAAU,IAAI,WAAW,CAC1D,CAGID,GACFA,EAAe,iBAAiB,QAAU,GAAM,CAC9C,EAAE,gBAAe,EACjBS,GACF,CAAC,EAIH,SAAS,iBAAiB,QAAU,GAAM,CACpCV,GAAY,CAACA,EAAS,SAAS,EAAE,MAAM,GACzCO,GAEJ,CAAC,EAGD,IAAI7B,EAAc,EACdiC,EAAY,GACZC,EAAW,GACXnC,EAAa,EAGjB,eAAeoC,GAAoB,CACjCC,IACA,MAAMC,EAAO,MAAMC,EAAmB,CAAC,EACvCC,IAEIF,GAAM,SAAS,SACjBG,EAAaH,EAAK,OAAO,EACrBA,EAAK,QAAQ,CAAC,GAChB,MAAMI,EAAoBJ,EAAK,QAAQ,CAAC,EAAE,GAAIjB,EAAaC,CAAW,EAG5E,CAGIL,GACFA,EAAK,iBAAiB,SAAU,MAAO,GAAM,CAC3C,EAAE,eAAc,EAChB,MAAM0B,EAAQzB,EAAM,MAAM,KAAI,EAGxB0B,EAAOjB,EAAYA,EAAU,MAAQ,GAEtCgB,IAEL1C,EAAc,EACdiC,EAAYS,EACZR,EAAWS,EAGXd,IAEA,MAAMe,EAAqBF,EAAOC,EAAM3C,CAAW,EACrD,CAAC,EAGH,eAAe4C,EAAqBF,EAAOC,EAAMhC,EAAM,CACrDyB,IACA,MAAMC,EAAO,MAAMQ,EAAaH,EAAO/B,EAAMgC,CAAI,EAGpD,GAFGJ,IAEC,CAACF,GAAM,SAAS,OAAQ,CAEvBnB,EAAU,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOtBC,EAAoB,UAAY,GAChCE,EAAY,UAAY,GACxBD,EAAY,MAAM,gBAAkB,OACpC,MACF,CACArB,EAAasC,EAAK,YAClBG,EAAaH,EAAK,OAAO,EAErBA,EAAK,QAAQ,CAAC,GAChB,MAAMI,EAAoBJ,EAAK,QAAQ,CAAC,EAAE,GAAIjB,EAAaC,CAAW,EAGxExB,EAAgBsB,EAAqBpB,EAAYY,EAAOmC,GAAY,CAClE9C,EAAc8C,EACdF,EAAqBX,EAAWC,EAAUY,CAAO,EACjD,OAAO,SAAS,CAAE,IAAK,EAAG,SAAU,QAAQ,CAAE,CAChD,CAAC,CACH,CAEA,SAASN,EAAaO,EAAM,CAC1B7B,EAAU,UAAY6B,EAAK,IAAKC,GAAMC,EAAgBD,CAAC,CAAC,EAAE,KAAK,EAAE,CACnE,CAEA9B,EAAU,iBAAiB,QAAU,GAAM,CACzC,MAAMgC,EAAO,EAAE,OAAO,QAAQ,aAAa,EACvCA,GAAQA,EAAK,QAAQ,KACvBT,EAAoBS,EAAK,QAAQ,GAAI9B,EAAaC,CAAW,EAC7D,OAAO,SAAS,CAAE,IAAK,EAAG,SAAU,QAAQ,CAAE,EAElD,CAAC,EAED,MAAMc,EAAiB,CACzB,EAEApB,EAAW"}